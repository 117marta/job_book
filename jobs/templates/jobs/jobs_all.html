{% extends "home_page/base.html" %}
{% load job_filters %}


{% block title %}{{ block.super }} Jobs{% endblock %}

{% block content %}

    <div class="container-fluid" style="background-color:lavenderblush;">
        <h2>Jobs list</h2>
        <p>All the workers on the construction.</p>

        <table class="table table-striped table-hover table-warning mt-5">
            <thead class="align-middle">
                <tr>
                    <th>ID</th>
                    <th>Principal</th>
                    <th>Contractor</th>
                    <th>Status</th>
                    <th>Kind</th>
                    <th>Description</th>
                    <th>Deadline</th>
                    <th>km from</th>
                    <th>km to</th>
                    <th>Trade</th>
                    <th>Comments</th>
                    <th>Created</th>
                </tr>
            </thead>
            <tbody>
                {% for job in page_object %}
                    <tr class="align-middle">
                        <td><a href="{% url "jobs-job" job_pk=job.pk %}">{{ job.pk }}</a></td>
                        <td>{{ job.principal.get_full_name }}</td>
                        <td>{{ job.contractor.get_full_name }}</td>
                        <td>
                            <span class="badge rounded-pill {% if job.status == "waiting" %}bg-light text-dark{% elif job.status == "accepted" %}bg-primary{% elif job.status == "finished" %}bg-success{% elif job.status == "refused" %}bg-danger{% elif job.status == "closed" %}bg-dark{% else %}bg-info text-dark{% endif %}">
                                {{ job.get_status_display | capfirst }}
                            </span>
                        </td>
                        <td>{{ job.get_kind_display | capfirst }}</td>
                        <td>{{ job.description }}</td>
                        <td>{{ job.deadline | date:"d.m.Y" }}</td>
                        <td>{{ job.km_from | km }}</td>
                        <td>{% if job.km_to %}{{ job.km_to | km }}{% else %}-{% endif %}</td>
                        <td><span class="badge bg-secondary" >{{ job.trade }}</span></td>
                        <td>{{ job.comments }}</td>
                        <td>{{ job.created | date:"d.m.Y H:i" }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>

        <nav aria-label="Page navigation example">
            <ul class="pagination justify-content-center">
                <li class="page-item {% if not page_object.has_previous %}disabled{% endif %}">
                    <a class="page-link" href="{% if page_object.has_previous %}?page={{ page_object.previous_page_number }}{% endif %}">◀️ Previous</a>
                </li>

                {% for page in adjusted_elided_pages %}
                    {% if page_object.number == page %}
                        <li class="page-item active">
                            <a class="page-link">{{ page }}</a>
                        </li>
                    {% else %}
                        {% if page == paginator.ELLIPSIS %}
                            <li class="page-item">
                                <span class="page-link">{{ paginator.ELLIPSIS }}</span>
                            </li>
                        {% else %}
                            <li class="page-item">
                                <a class="page-link" href="?page={{ page }}">{{ page }}</a>
                            </li>
                        {% endif %}
                    {% endif %}
                {% endfor %}

                <li class="page-item {% if not page_object.has_next %}disabled{% endif %}">
                    <a class="page-link" href="{% if page_object.has_next %}?page={{ page_object.next_page_number }}{% endif %}">Next ️▶️</a>
                </li>
            </ul>
        </nav>
    </div>

{% endblock %}
